SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;

---

SELECT C_LAST_NAME, C_FIRST_NAME, C_SALUTATION, C_PREFERRED_CUST_FLAG, SS_TICKET_NUMBER, CNT
FROM
		(SELECT SS_TICKET_NUMBER, SS_CUSTOMER_SK, COUNT(*) CNT
			FROM STORE_SALES, DATE_DIM, STORE, HOUSEHOLD_DEMOGRAPHICS
			WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK
					AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK
					AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND DATE_DIM.D_DOM BETWEEN 1 AND 2
					AND (HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = 'Unknown'
										OR HOUSEHOLD_DEMOGRAPHICS.HD_BUY_POTENTIAL = '>10000')
					AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0
					AND CASE
													WHEN HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 0 THEN HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT / HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT
													ELSE NULL
									END > 1
					AND DATE_DIM.D_YEAR IN (1999, 1999 + 1, 1999 + 2)
					AND STORE.S_COUNTY IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')
			GROUP BY SS_TICKET_NUMBER, SS_CUSTOMER_SK) DJ, CUSTOMER
WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK
		AND CNT BETWEEN 1 AND 5
ORDER BY CNT DESC, C_LAST_NAME ASC;
