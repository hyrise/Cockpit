WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;

---

WITH SR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(SR_RETURN_QUANTITY) SR_ITEM_QTY
			FROM STORE_RETURNS, ITEM, DATE_DIM
			WHERE SR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND SR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	CR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(CR_RETURN_QUANTITY) CR_ITEM_QTY
			FROM CATALOG_RETURNS, ITEM, DATE_DIM
			WHERE CR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND CR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID),
	WR_ITEMS AS
		(SELECT I_ITEM_ID ITEM_ID, SUM(WR_RETURN_QUANTITY) WR_ITEM_QTY
			FROM WEB_RETURNS, ITEM, DATE_DIM
			WHERE WR_ITEM_SK = I_ITEM_SK
					AND D_DATE IN
							(SELECT D_DATE
								FROM DATE_DIM
								WHERE D_WEEK_SEQ IN
												(SELECT D_WEEK_SEQ
													FROM DATE_DIM
													WHERE D_DATE IN ('2000-06-30', '2000-09-27', '2000-11-17')))
					AND WR_RETURNED_DATE_SK = D_DATE_SK
			GROUP BY I_ITEM_ID)
SELECT SR_ITEMS.ITEM_ID, SR_ITEM_QTY,
	(SR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 SR_DEV, CR_ITEM_QTY,
	(CR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 CR_DEV, WR_ITEM_QTY,
	(WR_ITEM_QTY * 1.0000) / (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0000 * 100 WR_DEV, (SR_ITEM_QTY + CR_ITEM_QTY + WR_ITEM_QTY) / 3.0 AVERAGE
FROM SR_ITEMS, CR_ITEMS, WR_ITEMS
WHERE SR_ITEMS.ITEM_ID = CR_ITEMS.ITEM_ID
		AND SR_ITEMS.ITEM_ID = WR_ITEMS.ITEM_ID
ORDER BY SR_ITEMS.ITEM_ID, SR_ITEM_QTY
LIMIT 100;
