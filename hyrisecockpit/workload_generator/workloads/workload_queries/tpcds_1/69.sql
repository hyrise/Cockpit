SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;

---

SELECT CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, COUNT(*) CNT1, CD_PURCHASE_ESTIMATE, COUNT(*) CNT2,
	CD_CREDIT_RATING, COUNT(*) CNT3
FROM CUSTOMER C, CUSTOMER_ADDRESS CA, CUSTOMER_DEMOGRAPHICS
WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK
		AND CA_STATE IN ('KY', 'GA', 'NM')
		AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK
		AND EXISTS
				(SELECT *
					FROM STORE_SALES, DATE_DIM
					WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK
							AND SS_SOLD_DATE_SK = D_DATE_SK
							AND D_YEAR = 2001
							AND D_MOY BETWEEN 4 AND 4 + 2)
		AND (NOT EXISTS
									(SELECT *
										FROM WEB_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK
												AND WS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2)
							AND NOT EXISTS
									(SELECT *
										FROM CATALOG_SALES, DATE_DIM
										WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK
												AND CS_SOLD_DATE_SK = D_DATE_SK
												AND D_YEAR = 2001
												AND D_MOY BETWEEN 4 AND 4 + 2))
GROUP BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
ORDER BY CD_GENDER, CD_MARITAL_STATUS, CD_EDUCATION_STATUS, CD_PURCHASE_ESTIMATE, CD_CREDIT_RATING
LIMIT 100;
