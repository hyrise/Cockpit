SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;

---

SELECT CASE
											WHEN
																		(SELECT COUNT(*)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20) > 74129 THEN
																		(SELECT AVG(SS_EXT_DISCOUNT_AMT)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
											ELSE
																		(SELECT AVG(SS_NET_PAID)
																			FROM STORE_SALES
																			WHERE SS_QUANTITY BETWEEN 1 AND 20)
							END BUCKET1,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40) > 122840 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 21 AND 40)
	END BUCKET2,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60) > 56580 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 41 AND 60)
	END BUCKET3,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80) > 10097 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 61 AND 80)
	END BUCKET4,
	CASE
					WHEN
												(SELECT COUNT(*)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100) > 165306 THEN
												(SELECT AVG(SS_EXT_DISCOUNT_AMT)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
					ELSE
												(SELECT AVG(SS_NET_PAID)
													FROM STORE_SALES
													WHERE SS_QUANTITY BETWEEN 81 AND 100)
	END BUCKET5
FROM REASON
WHERE R_REASON_SK = 1 ;
