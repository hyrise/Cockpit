SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;

---

SELECT SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
FROM WEB_SALES, WEB_RETURNS, WEB_PAGE, CUSTOMER_DEMOGRAPHICS CD1, CUSTOMER_DEMOGRAPHICS CD2,
	CUSTOMER_ADDRESS, DATE_DIM, REASON
WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK
		AND WS_ITEM_SK = WR_ITEM_SK
		AND WS_ORDER_NUMBER = WR_ORDER_NUMBER
		AND WS_SOLD_DATE_SK = D_DATE_SK
		AND D_YEAR = 2000
		AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK
		AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK
		AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK
		AND R_REASON_SK = WR_REASON_SK
		AND ((CD1.CD_MARITAL_STATUS = 'M'
								AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
								AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree'
								AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
								AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00)
							OR (CD1.CD_MARITAL_STATUS = 'S'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = 'College'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00)
							OR (CD1.CD_MARITAL_STATUS = 'W'
											AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS
											AND CD1.CD_EDUCATION_STATUS = '2 yr Degree'
											AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS
											AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00))
		AND ((CA_COUNTRY = 'United States'
								AND CA_STATE IN ('IN', 'OH', 'NJ')
								AND WS_NET_PROFIT BETWEEN 100 AND 200)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('WI', 'CT', 'KY')
											AND WS_NET_PROFIT BETWEEN 150 AND 300)
							OR (CA_COUNTRY = 'United States'
											AND CA_STATE IN ('LA', 'IA', 'AR')
											AND WS_NET_PROFIT BETWEEN 50 AND 250))
GROUP BY R_REASON_DESC
ORDER BY SUBSTR(R_REASON_DESC, 1, 20), AVG(WS_QUANTITY), AVG(WR_REFUNDED_CASH), AVG(WR_FEE)
LIMIT 100;
