WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;

---

WITH CUSTOMER_TOTAL_RETURN AS
		(SELECT CR_RETURNING_CUSTOMER_SK AS CTR_CUSTOMER_SK, CA_STATE AS CTR_STATE, SUM(CR_RETURN_AMT_INC_TAX) AS CTR_TOTAL_RETURN
			FROM CATALOG_RETURNS, DATE_DIM, CUSTOMER_ADDRESS
			WHERE CR_RETURNED_DATE_SK = D_DATE_SK
					AND D_YEAR = 2000
					AND CR_RETURNING_ADDR_SK = CA_ADDRESS_SK
			GROUP BY CR_RETURNING_CUSTOMER_SK, CA_STATE)
SELECT C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
FROM CUSTOMER_TOTAL_RETURN CTR1, CUSTOMER_ADDRESS, CUSTOMER
WHERE CTR1.CTR_TOTAL_RETURN >
				(SELECT AVG(CTR_TOTAL_RETURN) * 1.2
					FROM CUSTOMER_TOTAL_RETURN CTR2
					WHERE CTR1.CTR_STATE = CTR2.CTR_STATE)
		AND CA_ADDRESS_SK = C_CURRENT_ADDR_SK
		AND CA_STATE = 'GA'
		AND CTR1.CTR_CUSTOMER_SK = C_CUSTOMER_SK
ORDER BY C_CUSTOMER_ID, C_SALUTATION, C_FIRST_NAME, C_LAST_NAME, CA_STREET_NUMBER, CA_STREET_NAME, CA_STREET_TYPE,
	CA_SUITE_NUMBER, CA_CITY, CA_COUNTY, CA_STATE, CA_ZIP, CA_COUNTRY, CA_GMT_OFFSET, CA_LOCATION_TYPE,
	CTR_TOTAL_RETURN
LIMIT 100;
