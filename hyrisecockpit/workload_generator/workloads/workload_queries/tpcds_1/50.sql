SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;

---

SELECT S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP,
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 30) THEN 1
									ELSE 0
					END) AS "30 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 30)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 60) THEN 1
									ELSE 0
					END) AS "31-60 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 60)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 90) THEN 1
									ELSE 0
					END) AS "61-90 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 90)
														AND (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK <= 120) THEN 1
									ELSE 0
					END) AS "91-120 days",
	SUM(CASE
									WHEN (SR_RETURNED_DATE_SK - SS_SOLD_DATE_SK > 120) THEN 1
									ELSE 0
					END) AS ">120 days"
FROM STORE_SALES, STORE_RETURNS, STORE, DATE_DIM D1, DATE_DIM D2
WHERE D2.D_YEAR = 2001
		AND D2.D_MOY = 8
		AND SS_TICKET_NUMBER = SR_TICKET_NUMBER
		AND SS_ITEM_SK = SR_ITEM_SK
		AND SS_SOLD_DATE_SK = D1.D_DATE_SK
		AND SR_RETURNED_DATE_SK = D2.D_DATE_SK
		AND SS_CUSTOMER_SK = SR_CUSTOMER_SK
		AND SS_STORE_SK = S_STORE_SK
GROUP BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
ORDER BY S_STORE_NAME, S_COMPANY_ID, S_STREET_NUMBER, S_STREET_NAME, S_STREET_TYPE, S_SUITE_NUMBER, S_CITY,
	S_COUNTY, S_STATE, S_ZIP
LIMIT 100;
