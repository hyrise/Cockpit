SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;

---

SELECT *
FROM
		(SELECT COUNT(*) H8_30_TO_9
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 8
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S1,

		(SELECT COUNT(*) H9_TO_9_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S2,

		(SELECT COUNT(*) H9_30_TO_10
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 9
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S3,

		(SELECT COUNT(*) H10_TO_10_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S4,

		(SELECT COUNT(*) H10_30_TO_11
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 10
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S5,

		(SELECT COUNT(*) H11_TO_11_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S6,

		(SELECT COUNT(*) H11_30_TO_12
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 11
					AND TIME_DIM.T_MINUTE >= 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S7,

		(SELECT COUNT(*) H12_TO_12_30
			FROM STORE_SALES, HOUSEHOLD_DEMOGRAPHICS, TIME_DIM, STORE
			WHERE SS_SOLD_TIME_SK = TIME_DIM.T_TIME_SK
					AND SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK
					AND SS_STORE_SK = S_STORE_SK
					AND TIME_DIM.T_HOUR = 12
					AND TIME_DIM.T_MINUTE < 30
					AND ((HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 4
											AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 4 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 2
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 2 + 2)
										OR (HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0
														AND HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT <= 0 + 2))
					AND STORE.S_STORE_NAME = 'ese') S8 ;
